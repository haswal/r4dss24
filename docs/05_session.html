<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2024-09-05" />

<title>Session 5</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">r4dss24</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Getting Started</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sessions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_session.html">Session 1</a>
    </li>
    <li>
      <a href="02_session.html">Session 2</a>
    </li>
    <li>
      <a href="03_session.html">Session 3</a>
    </li>
    <li>
      <a href="04_session.html">Session 4</a>
    </li>
    <li>
      <a href="05_session.html">Session 5</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Session 5</h1>
<h4 class="date">September 5, 2024</h4>

</div>


<div id="agenda" class="section level2">
<h2>Agenda</h2>
<ul>
<li>dplyr continued</li>
<li>Create new variables with <code>mutate()</code></li>
<li>Group data using <code>group_by()</code></li>
<li>Create (grouped) summaries with <code>summarise()</code></li>
</ul>
</div>
<div id="script" class="section level2">
<h2>Script</h2>
<p>You can download the session 5 script by clicking the link below.</p>
<!-- to add scripts -->
<!-- ```{r, include = FALSE, eval = FALSE} -->
<!-- # install and load these packages -->
<!-- devtools::install_github('yihui/xfun') -->
<!-- # embed_file() requires a few more packages -->
<!-- xfun::pkg_load2(c('base64enc', 'htmltools', 'mime')) -->
<!-- ``` -->
<!-- ```{r echo=FALSE} -->
<!-- # a embed single file -->
<!-- xfun::embed_file('session_05.R') -->
<!-- ``` -->
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<p>We will continue to talk about things covered in Chapter 5, this time
sections 5.5 - 5.7.</p>
<p>The <code>kableExtra</code> package is great for styling tables
created by for example <code>summarise()</code>. Information about this
package can be found <a
href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">here</a>.</p>
</div>
<div id="homework-exercises" class="section level2">
<h2>Homework Exercises</h2>
<p>The session 5 homework is below. All code solutions should be
completed using <strong>one</strong> (sometimes rather long)
pipeline.</p>
<ol style="list-style-type: decimal">
<li><p>Recreate the code to make the plot below. Make sure your code
includes the fix we talked about during the Thursday session to correct
the Weight observations made by <code>raID-07</code>.</p>
<p><img src="05_session_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;" /></p></li>
<li><p>Use <code>group_by()</code> and <code>mutate()</code> to
calculate the median Volume per Observer, and call the new column
<code>median_Volume</code>.</p></li>
<li><p>Find the largest Volume measurement per phase, using
<code>group_by()</code>, <code>summarise()</code> and
<code>max()</code>.</p></li>
<li><p>How many observations per phase has a Weight less than 10
grams?</p></li>
<li><p>Mean-center (subtract the mean from all the individual
observations) the <code>Weight</code> variable (corrected). What is the
mean of this new variable?</p></li>
<li><p>Mean-center the Volume variable for each phase
separately.</p></li>
<li><p>Recreate the plot below, but instead of asking
<code>geom_bar()</code> and <code>geom_errorbar()</code> to calculate
the mean and the standard error, calculate these values yourself using
<code>group_by()</code> and <code>summarise()</code>. Once these summary
statistics are calculated, pipe to <code>ggplot()</code> and add the
code necessary to produce the plot. Use google to figure out how to
calculate standard errors and how to use pre-calculated values with
<code>geom_bar()</code> and <code>geom_errorbar()</code>.</p>
<p><img src="05_session_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;" /></p></li>
<li><p>Using the plot above as a starting point, create two new plots;
one with errorbars representing the median absolute deviation and one
with errorbars representing 95% confidence intervals (Hint: 95% CIs are
calculated by multiplying the standard error with a certain
constant).</p></li>
<li><p>During session 4, we talked about how to use the <code>DT</code>
package to create interactive tables in R markdown. These are perhaps
most suited for large tables where showing all information would be
problematic without the ability to produced paged, clickable tables.
Many times when working in R we produce smaller tables, which is often
the case when working <code>group_by()</code> and
<code>summarise()</code> for example. Out of the box, these tables donâ€™t
look very good when knitting a html document. Check the resources and
see if you can reproduce the code necessary to make the table below.</p>
<style type="text/css">
 table tr td p {
   margin: 4px;
 }

 thead p {
   margin: 4px;
 }

 caption p {
   margin: 0px;
 }

 </style>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<p>Table 1: Cloudbuddy Volume</p>
</caption>
<thead>
<tr>
<th style="text-align:left;">
<p>Phase (color)</p>
</th>
<th style="text-align:right;">
<p>mean</p>
</th>
<th style="text-align:right;">
<p>stdev</p>
</th>
<th style="text-align:right;">
<p>n</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: lightgray !important;">
<p>1-lightgray</p>
</td>
<td style="text-align:right;color: black !important;background-color: lightgray !important;">
<p>1.79</p>
</td>
<td style="text-align:right;color: black !important;background-color: lightgray !important;">
<p>1.95</p>
</td>
<td style="text-align:right;color: black !important;background-color: lightgray !important;">
<p>199</p>
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: darkgray !important;">
<p>2-darkgray</p>
</td>
<td style="text-align:right;color: black !important;background-color: darkgray !important;">
<p>8.08</p>
</td>
<td style="text-align:right;color: black !important;background-color: darkgray !important;">
<p>1.49</p>
</td>
<td style="text-align:right;color: black !important;background-color: darkgray !important;">
<p>202</p>
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: darkorange !important;">
<p>3-darkorange</p>
</td>
<td style="text-align:right;color: black !important;background-color: darkorange !important;">
<p>5.89</p>
</td>
<td style="text-align:right;color: black !important;background-color: darkorange !important;">
<p>1.77</p>
</td>
<td style="text-align:right;color: black !important;background-color: darkorange !important;">
<p>199</p>
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: orange !important;">
<p>4-orange</p>
</td>
<td style="text-align:right;color: black !important;background-color: orange !important;">
<p>3.71</p>
</td>
<td style="text-align:right;color: black !important;background-color: orange !important;">
<p>1.09</p>
</td>
<td style="text-align:right;color: black !important;background-color: orange !important;">
<p>196</p>
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: orangered !important;">
<p>5-orangered</p>
</td>
<td style="text-align:right;color: black !important;background-color: orangered !important;">
<p>3.22</p>
</td>
<td style="text-align:right;color: black !important;background-color: orangered !important;">
<p>0.94</p>
</td>
<td style="text-align:right;color: black !important;background-color: orangered !important;">
<p>199</p>
</td>
</tr>
<tr>
<td style="text-align:left;color: black !important;background-color: red !important;">
<p>6-red</p>
</td>
<td style="text-align:right;color: black !important;background-color: red !important;">
<p>0.56</p>
</td>
<td style="text-align:right;color: black !important;background-color: red !important;">
<p>0.72</p>
</td>
<td style="text-align:right;color: black !important;background-color: red !important;">
<p>191</p>
</td>
</tr>
</tbody>
</table></li>
<li><p>Calculate the difference in mean Volume between observations
younger than the median age and observations older than the median age.
The <code>diff()</code> function might be useful in this case.</p></li>
<li><p>Calculate the minimum Volume for each cloudbuddy and phase. Next,
calculate the mean of all the minimum values you just generated (the
output should contain one value only). Does it make a difference if you
remove NAs in the beginning of the pipeline using <code>filter()</code>,
if you use <code>na.rm = TRUE</code> when calculating the minimum
values, or if you use <code>na.rm = TRUE</code> when calculating the
mean? Pay attention to messages produced (warnings and such) when trying
the three different options and explain any differences in the
output.</p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
